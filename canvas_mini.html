<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <!--[if lt IE 9]><script type="text/javascript" src="../excanvas/excanvas.js"></script><![endif]-->
    <title>HMM Logos</title>
    <style>
      .clearfix img {
        position:absolute;
        border:none;
        top:0;
        left:0;
        display:none;
      }
      .clearfix {
        position:relative;
      }
      canvas {
        height: 300px;
      }
    </style>
    <script>

      var context = null;

      function isCanvasSupported(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
      }


      $.fn.hmm_logo = function(data) {

        var columns = [
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:1'],
          ['C:0.5','G:0.5','A:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['C:0.1','G:0.4','A:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:1','G:0','C:0','T:0'],
          ['A:1','G:0','C:0','T:0'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.1','G:0.4','C:0.1','T:0.01'],
          ['A:0.6','G:0.02','C:0.03','T:0.04'],
          ['A:0.01','G:0.7','C:0.2','T:0.01'],
          ['A:0.01','G:0.01','C:0.02','T:0.01'],
          ['G:0.2','G:0.2','G:0.2','G:0.2','G:0.2'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:1','C:0','T:0'],
          ['A:0','G:0.9','C:0','T:0'],
          ['A:0','G:0.8','C:0','T:0'],
          ['A:0','G:0.7','C:0','T:0'],
          ['A:0','G:0.6','C:0','T:0'],
          ['A:0','G:0.5','C:0','T:0'],
          ['A:0','G:0.4','C:0','T:0'],
          ['A:0','G:0.3','C:0','T:0'],
          ['A:0','G:0.2','C:0','T:0'],
          ['A:0','G:0.1','C:0','T:0'],
          ['A:0','G:0','C:0','T:0'],
          ['A:0.9','G:0','C:0','T:0'],
          ['A:0.8','G:0','C:0','T:0'],
          ['A:0.7','G:0','C:0','T:0'],
          ['A:0.6','G:0','C:0.6','T:0'],
          ['A:0.5','G:0','C:0','T:0'],
          ['A:0.4','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.2','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0.3','G:0','C:0','T:0'],
          ['A:0.1','G:0','C:0','T:0'],
          ['A:0','G:0','C:0','T:0']
        ];
        /*var columns = [
          ['A:0.25','G:0.25','C:0.25','T:0.25'],
          ['A:1','G:0','C:0','T:0'],
          ['A:0.25','G:0','C:0','T:0'],
          ['A:1','G:0','C:0','T:0']
        ];*/

        var column_width = 4;
        var vis_width   = $(this).width();
        var x = 0;
        var y = 285;
        var column_num = 1;
        var colors = {
          'A': '#cbf751',
          'C': '#5ec0cc',
          'G': '#ffdf59',
          'T': '#b51f16',
          'U': '#b51f16'
        };

        var image_width = columns.length * column_width;

        // create the canvas here.
        if(isCanvasSupported()) {
          $(this).append('<canvas id="canv" height="300" width="'+ image_width + '"></canvas>');
        }

        var canvas = $(this).find('#canv')[0];

        context = canvas.getContext("2d");

        var max_cols = columns.length;
        context.strokeStyle = "rgba(0, 0, 0, 1)";

        // loop for each column
        for ( var i = 0; i < max_cols; i++ ) {
          var column = columns[i];
          var previous_height = 0;
          var letters = column.length;
          // draw each value in the column
 
          for ( var j = 0; j < letters; j++ ) {
            var letter = column[j];
            var values = letter.split(':', 2);
            if (values[1] > 0.1) {
              var x_pos = x;
              var glyph_height = 262 * values[1];
              var y_pos = 269 - previous_height - glyph_height;
              context.fillStyle = colors[values[0]];
              context.fillRect (x_pos, y_pos, column_width, glyph_height);


              previous_height = previous_height + glyph_height;

            }
           }

          // draw top ticks
          context.beginPath();
          context.moveTo(x, 0);
          context.lineTo(x, 5);
          context.strokeStyle = "#999999";
          context.stroke();

          // draw column divider lines
          context.beginPath();
          context.moveTo(x, 270);
          context.lineTo(x, 0);
          context.strokeStyle = "#dddddd";
          context.stroke();

          //draw insert odds
          var odds = (Math.random() * 1).toFixed(2);
          var odds_fill = '#666666';
          if (odds > 0.6) {
            odds_fill = '#333333';
          }

          context.font = "10px Arial";
          context.textAlign = "center";
          context.fillStyle = odds_fill;
          context.fillText(odds, x + (column_width / 2), 270 + 10);

          // increment for the next column
          column_num++;
          x = x + column_width;
        }
      }


      $(document).ready(function() {
        $('#graphic').hmm_logo();
      });
    </script>
  </head>
  <body>
    <div id="container">
      <div id="graphic" data-scrollable="x" data-zoomable="0.1-1">
        <!--[if lt IE 9]><canvas id="canv" height="300" width="20000"></canvas><![endif]-->
      </div>
    </div>
  </body>
</html>
